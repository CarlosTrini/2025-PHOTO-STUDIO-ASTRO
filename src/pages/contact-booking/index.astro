---
import FormContact from "@components/FormContact";
import Layout from "@layouts/Layout.astro";
import { Image } from "astro:assets";
import "@styles/pages/contactBooking.css";
import locationImage from "@assets/img/generic/location.png";
---

<Layout>
    <main class={`contact-main-page`}>
        <section class={`t-padding-header  contact-title-page`}>
            <h2 class={`t-page-titles`}>Deseamos conocerte</h2>
            <p class={``}>
                Lorem ipsum dolor sit amet consectetur adipisicing elit.
                Incidunt repudiandae, ipsa iure saepe deserunt consequatur
                consectetur autem illum fugit vitae?
            </p>
        </section>

        <section class={`contact-page-content`}>
            <!-- UBICACIÓN -->
            <figure class={`location-figure`}>
                <Image
                    src={locationImage}
                    alt="imagen de fondo ilustrariva de contacto y reserva"
                    loading={"lazy"}
                />
            </figure>
            <!-- TABS -->
            <section class={`tabs-contact-container`}>
                <div class={`tabs-container`}>
                    <ul class={`tabs-titles`}>
                        <li
                            data-tabtitle="contact"
                            class={`tab-title tab-selected`}
                        >
                            <p>
                                <svg
                                    xmlns="http://www.w3.org/2000/svg"
                                    height="20"
                                    width="20"
                                    viewBox="0 0 640 640"
                                    ><!--!Font Awesome Free v7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2026 Fonticons, Inc.-->
                                    <path
                                        fill="#f8f7f2"
                                        d="M112 128C85.5 128 64 149.5 64 176C64 191.1 71.1 205.3 83.2 214.4L291.2 370.4C308.3 383.2 331.7 383.2 348.8 370.4L556.8 214.4C568.9 205.3 576 191.1 576 176C576 149.5 554.5 128 528 128L112 128zM64 260L64 448C64 483.3 92.7 512 128 512L512 512C547.3 512 576 483.3 576 448L576 260L377.6 408.8C343.5 434.4 296.5 434.4 262.4 408.8L64 260z"
                                    ></path></svg
                                >Contáctanos
                            </p>
                        </li>
                        <li data-tabtitle="booking" class={`tab-title`}>
                            <p>
                                <svg
                                    xmlns="http://www.w3.org/2000/svg"
                                    height="20"
                                    width="20"
                                    viewBox="0 0 640 640"
                                    ><path
                                        fill="#f8f7f2"
                                        d="M160 64C124.7 64 96 92.7 96 128L96 512C96 547.3 124.7 576 160 576L448 576C483.3 576 512 547.3 512 512L512 128C512 92.7 483.3 64 448 64L160 64zM272 352L336 352C380.2 352 416 387.8 416 432C416 440.8 408.8 448 400 448L208 448C199.2 448 192 440.8 192 432C192 387.8 227.8 352 272 352zM248 256C248 225.1 273.1 200 304 200C334.9 200 360 225.1 360 256C360 286.9 334.9 312 304 312C273.1 312 248 286.9 248 256zM576 144C576 135.2 568.8 128 560 128C551.2 128 544 135.2 544 144L544 208C544 216.8 551.2 224 560 224C568.8 224 576 216.8 576 208L576 144zM576 272C576 263.2 568.8 256 560 256C551.2 256 544 263.2 544 272L544 336C544 344.8 551.2 352 560 352C568.8 352 576 344.8 576 336L576 272zM560 384C551.2 384 544 391.2 544 400L544 464C544 472.8 551.2 480 560 480C568.8 480 576 472.8 576 464L576 400C576 391.2 568.8 384 560 384z"
                                    ></path></svg
                                >Reserva
                            </p>
                        </li>
                    </ul>

                    <div class="tabs-content form-content">
                        <div
                            data-tabcontainer="contact"
                            class={`visible-tab form-contact-container`}
                        >
                            <h2>CONTACTO</h2>
                            <FormContact formType="contact" client:load />
                        </div>
                        <div
                            data-tabcontainer="booking"
                            class={`hidden-tab form-contact-container`}
                        >
                            <h2>RESERVA</h2>
                            <FormContact formType="booking" />
                        </div>
                    </div>
                </div>
            </section>
        </section>
    </main>
</Layout>

<script>
    // ESTO TIENE CHANCE DE CONVERTIRSE A COMPONENTES...
    const tabsCache = new Map();
    const initTabs = () => {
        const tabTitles = Array.from(
            document.querySelectorAll("[data-tabtitle]"),
        ) as HTMLElement[];

        tabTitles.forEach((tabTitle) => {
            const tabId = tabTitle.dataset.tabtitle;
            const tabContainer = document.querySelector(
                `[data-tabcontainer="${tabId}"]`,
            ) as HTMLElement;

            if (tabContainer && tabId) {
                // guardar la referencia al nodo del DOM en el cache
                tabsCache.set(tabId, {
                    tab: tabTitle,
                    container: tabContainer,
                });

                //asignar el evento
                tabTitle.addEventListener("click", () => openTab(tabId));
                // tabTitle.addEventListener("mouseenter", () => openTab(tabId));
            }
        });
    };

    const openTab = (tabId: string) => {
        closeTabs();
        let tabItem = tabsCache.get(tabId);
        if (!tabItem) return;

        tabItem.container.classList.toggle(`hidden-tab`);
        tabItem.container.classList.toggle(`visible-tab`);
        tabItem.tab.classList.toggle(`tab-selected`);
    };

    function closeTabs() {
        tabsCache.forEach((tab) => {
            tab.container.classList.remove("visible-tab");
            tab.container.classList.add("hidden-tab");
            tab.tab.classList.remove("tab-selected");
        });
    }

    window.addEventListener("DOMContentLoaded", () => {
        initTabs();
    });
</script>
